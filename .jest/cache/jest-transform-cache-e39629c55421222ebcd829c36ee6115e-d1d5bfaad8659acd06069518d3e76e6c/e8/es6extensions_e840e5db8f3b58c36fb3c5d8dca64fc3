cbcfa0b28a80ec10c860f3f11185b966
'use strict';

var Promise = require('./core.js');

module.exports = Promise;
var TRUE = valuePromise(true);
var FALSE = valuePromise(false);
var NULL = valuePromise(null);
var UNDEFINED = valuePromise(undefined);
var ZERO = valuePromise(0);
var EMPTYSTRING = valuePromise('');

function valuePromise(value) {
  var p = new Promise(Promise._0);
  p._V = 1;
  p._W = value;
  return p;
}

Promise.resolve = function (value) {
  if (value instanceof Promise) return value;
  if (value === null) return NULL;
  if (value === undefined) return UNDEFINED;
  if (value === true) return TRUE;
  if (value === false) return FALSE;
  if (value === 0) return ZERO;
  if (value === '') return EMPTYSTRING;

  if (typeof value === 'object' || typeof value === 'function') {
    try {
      var then = value.then;

      if (typeof then === 'function') {
        return new Promise(then.bind(value));
      }
    } catch (ex) {
      return new Promise(function (resolve, reject) {
        reject(ex);
      });
    }
  }

  return valuePromise(value);
};

var _iterableToArray = function iterableToArray(iterable) {
  if (typeof Array.from === 'function') {
    _iterableToArray = Array.from;
    return Array.from(iterable);
  }

  _iterableToArray = function iterableToArray(x) {
    return Array.prototype.slice.call(x);
  };

  return Array.prototype.slice.call(iterable);
};

Promise.all = function (arr) {
  var args = _iterableToArray(arr);

  return new Promise(function (resolve, reject) {
    if (args.length === 0) return resolve([]);
    var remaining = args.length;

    function res(i, val) {
      if (val && (typeof val === 'object' || typeof val === 'function')) {
        if (val instanceof Promise && val.then === Promise.prototype.then) {
          while (val._V === 3) {
            val = val._W;
          }

          if (val._V === 1) return res(i, val._W);
          if (val._V === 2) reject(val._W);
          val.then(function (val) {
            res(i, val);
          }, reject);
          return;
        } else {
          var then = val.then;

          if (typeof then === 'function') {
            var p = new Promise(then.bind(val));
            p.then(function (val) {
              res(i, val);
            }, reject);
            return;
          }
        }
      }

      args[i] = val;

      if (--remaining === 0) {
        resolve(args);
      }
    }

    for (var i = 0; i < args.length; i++) {
      res(i, args[i]);
    }
  });
};

Promise.reject = function (value) {
  return new Promise(function (resolve, reject) {
    reject(value);
  });
};

Promise.race = function (values) {
  return new Promise(function (resolve, reject) {
    _iterableToArray(values).forEach(function (value) {
      Promise.resolve(value).then(resolve, reject);
    });
  });
};

Promise.prototype['catch'] = function (onRejected) {
  return this.then(null, onRejected);
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVzNi1leHRlbnNpb25zLmpzIl0sIm5hbWVzIjpbIlByb21pc2UiLCJyZXF1aXJlIiwibW9kdWxlIiwiZXhwb3J0cyIsIlRSVUUiLCJ2YWx1ZVByb21pc2UiLCJGQUxTRSIsIk5VTEwiLCJVTkRFRklORUQiLCJ1bmRlZmluZWQiLCJaRVJPIiwiRU1QVFlTVFJJTkciLCJ2YWx1ZSIsInAiLCJfMCIsIl9WIiwiX1ciLCJyZXNvbHZlIiwidGhlbiIsImJpbmQiLCJleCIsInJlamVjdCIsIml0ZXJhYmxlVG9BcnJheSIsIml0ZXJhYmxlIiwiQXJyYXkiLCJmcm9tIiwieCIsInByb3RvdHlwZSIsInNsaWNlIiwiY2FsbCIsImFsbCIsImFyciIsImFyZ3MiLCJsZW5ndGgiLCJyZW1haW5pbmciLCJyZXMiLCJpIiwidmFsIiwicmFjZSIsInZhbHVlcyIsImZvckVhY2giLCJvblJlamVjdGVkIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFJQSxJQUFJQSxPQUFPLEdBQUdDLE9BQU8sQ0FBQyxXQUFELENBQXJCOztBQUVBQyxNQUFNLENBQUNDLE9BQVAsR0FBaUJILE9BQWpCO0FBSUEsSUFBSUksSUFBSSxHQUFHQyxZQUFZLENBQUMsSUFBRCxDQUF2QjtBQUNBLElBQUlDLEtBQUssR0FBR0QsWUFBWSxDQUFDLEtBQUQsQ0FBeEI7QUFDQSxJQUFJRSxJQUFJLEdBQUdGLFlBQVksQ0FBQyxJQUFELENBQXZCO0FBQ0EsSUFBSUcsU0FBUyxHQUFHSCxZQUFZLENBQUNJLFNBQUQsQ0FBNUI7QUFDQSxJQUFJQyxJQUFJLEdBQUdMLFlBQVksQ0FBQyxDQUFELENBQXZCO0FBQ0EsSUFBSU0sV0FBVyxHQUFHTixZQUFZLENBQUMsRUFBRCxDQUE5Qjs7QUFFQSxTQUFTQSxZQUFULENBQXNCTyxLQUF0QixFQUE2QjtBQUMzQixNQUFJQyxDQUFDLEdBQUcsSUFBSWIsT0FBSixDQUFZQSxPQUFPLENBQUNjLEVBQXBCLENBQVI7QUFDQUQsRUFBQUEsQ0FBQyxDQUFDRSxFQUFGLEdBQU8sQ0FB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SSxDQUFELENBQVIsQ0FBSDtBQUNEO0FBQ0YsR0FsQ00sQ0FBUDtBQW1DRCxDQXRDRDs7QUF3Q0FwQyxPQUFPLENBQUNxQixNQUFSLEdBQWlCLFVBQVVULEtBQVYsRUFBaUI7QUFDaEMsU0FBTyxJQUFJWixPQUFKLENBQVksVUFBVWlCLE9BQVYsRUFBbUJJLE1BQW5CLEVBQTJCO0FBQzVDQSxJQUFBQSxNQUFNLENBQUNULEtBQUQsQ0FBTjtBQUNELEdBRk0sQ0FBUDtBQUdELENBSkQ7O0FBTUFaLE9BQU8sQ0FBQ3NDLElBQVIsR0FBZSxVQUFVQyxNQUFWLEVBQWtCO0FBQy9CLFNBQU8sSUFBSXZDLE9BQUosQ0FBWSxVQUFVaUIsT0FBVixFQUFtQkksTUFBbkIsRUFBMkI7QUFDNUNDLElBQUFBLGdCQUFlLENBQUNpQixNQUFELENBQWYsQ0FBd0JDLE9BQXhCLENBQWdDLFVBQVM1QixLQUFULEVBQWU7QUFDN0NaLE1BQUFBLE9BQU8sQ0FBQ2lCLE9BQVIsQ0FBZ0JMLEtBQWhCLEVBQXVCTSxJQUF2QixDQUE0QkQsT0FBNUIsRUFBcUNJLE1BQXJDO0FBQ0QsS0FGRDtBQUdELEdBSk0sQ0FBUDtBQUtELENBTkQ7O0FBVUFyQixPQUFPLENBQUMyQixTQUFSLENBQWtCLE9BQWxCLElBQTZCLFVBQVVjLFVBQVYsRUFBc0I7QUFDakQsU0FBTyxLQUFLdkIsSUFBTCxDQUFVLElBQVYsRUFBZ0J1QixVQUFoQixDQUFQO0FBQ0QsQ0FGRCIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuLy9UaGlzIGZpbGUgY29udGFpbnMgdGhlIEVTNiBleHRlbnNpb25zIHRvIHRoZSBjb3JlIFByb21pc2VzL0ErIEFQSVxuXG52YXIgUHJvbWlzZSA9IHJlcXVpcmUoJy4vY29yZS5qcycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFByb21pc2U7XG5cbi8qIFN0YXRpYyBGdW5jdGlvbnMgKi9cblxudmFyIFRSVUUgPSB2YWx1ZVByb21pc2UodHJ1ZSk7XG52YXIgRkFMU0UgPSB2YWx1ZVByb21pc2UoZmFsc2UpO1xudmFyIE5VTEwgPSB2YWx1ZVByb21pc2UobnVsbCk7XG52YXIgVU5ERUZJTkVEID0gdmFsdWVQcm9taXNlKHVuZGVmaW5lZCk7XG52YXIgWkVSTyA9IHZhbHVlUHJvbWlzZSgwKTtcbnZhciBFTVBUWVNUUklORyA9IHZhbHVlUHJvbWlzZSgnJyk7XG5cbmZ1bmN0aW9uIHZhbHVlUHJvbWlzZSh2YWx1ZSkge1xuICB2YXIgcCA9IG5ldyBQcm9taXNlKFByb21pc2UuXzApO1xuICBwLl9WID0gMTtcbiAgcC5fVyA9IHZhbHVlO1xuICByZXR1cm4gcDtcbn1cblByb21pc2UucmVzb2x2ZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICBpZiAodmFsdWUgaW5zdGFuY2VvZiBQcm9taXNlKSByZXR1cm4gdmFsdWU7XG5cbiAgaWYgKHZhbHVlID09PSBudWxsKSByZXR1cm4gTlVMTDtcbiAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybiBVTkRFRklORUQ7XG4gIGlmICh2YWx1ZSA9PT0gdHJ1ZSkgcmV0dXJuIFRSVUU7XG4gIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHJldHVybiBGQUxTRTtcbiAgaWYgKHZhbHVlID09PSAwKSByZXR1cm4gWkVSTztcbiAgaWYgKHZhbHVlID09PSAnJykgcmV0dXJuIEVNUFRZU1RSSU5HO1xuXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgIHRyeSB7XG4gICAgICB2YXIgdGhlbiA9IHZhbHVlLnRoZW47XG4gICAgICBpZiAodHlwZW9mIHRoZW4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHRoZW4uYmluZCh2YWx1ZSkpO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGV4KSB7XG4gICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICByZWplY3QoZXgpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG4gIHJldHVybiB2YWx1ZVByb21pc2UodmFsdWUpO1xufTtcblxudmFyIGl0ZXJhYmxlVG9BcnJheSA9IGZ1bmN0aW9uIChpdGVyYWJsZSkge1xuICBpZiAodHlwZW9mIEFycmF5LmZyb20gPT09ICdmdW5jdGlvbicpIHtcbiAgICAvLyBFUzIwMTUrLCBpdGVyYWJsZXMgZXhpc3RcbiAgICBpdGVyYWJsZVRvQXJyYXkgPSBBcnJheS5mcm9tO1xuICAgIHJldHVybiBBcnJheS5mcm9tKGl0ZXJhYmxlKTtcbiAgfVxuXG4gIC8vIEVTNSwgb25seSBhcnJheXMgYW5kIGFycmF5LWxpa2VzIGV4aXN0XG4gIGl0ZXJhYmxlVG9BcnJheSA9IGZ1bmN0aW9uICh4KSB7IHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh4KTsgfTtcbiAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGl0ZXJhYmxlKTtcbn1cblxuUHJvbWlzZS5hbGwgPSBmdW5jdGlvbiAoYXJyKSB7XG4gIHZhciBhcmdzID0gaXRlcmFibGVUb0FycmF5KGFycik7XG5cbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICBpZiAoYXJncy5sZW5ndGggPT09IDApIHJldHVybiByZXNvbHZlKFtdKTtcbiAgICB2YXIgcmVtYWluaW5nID0gYXJncy5sZW5ndGg7XG4gICAgZnVuY3Rpb24gcmVzKGksIHZhbCkge1xuICAgICAgaWYgKHZhbCAmJiAodHlwZW9mIHZhbCA9PT0gJ29iamVjdCcgfHwgdHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJykpIHtcbiAgICAgICAgaWYgKHZhbCBpbnN0YW5jZW9mIFByb21pc2UgJiYgdmFsLnRoZW4gPT09IFByb21pc2UucHJvdG90eXBlLnRoZW4pIHtcbiAgICAgICAgICB3aGlsZSAodmFsLl9WID09PSAzKSB7XG4gICAgICAgICAgICB2YWwgPSB2YWwuX1c7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh2YWwuX1YgPT09IDEpIHJldHVybiByZXMoaSwgdmFsLl9XKTtcbiAgICAgICAgICBpZiAodmFsLl9WID09PSAyKSByZWplY3QodmFsLl9XKTtcbiAgICAgICAgICB2YWwudGhlbihmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICByZXMoaSwgdmFsKTtcbiAgICAgICAgICB9LCByZWplY3QpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2YXIgdGhlbiA9IHZhbC50aGVuO1xuICAgICAgICAgIGlmICh0eXBlb2YgdGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgdmFyIHAgPSBuZXcgUHJvbWlzZSh0aGVuLmJpbmQodmFsKSk7XG4gICAgICAgICAgICBwLnRoZW4oZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICByZXMoaSwgdmFsKTtcbiAgICAgICAgICAgIH0sIHJlamVjdCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBhcmdzW2ldID0gdmFsO1xuICAgICAgaWYgKC0tcmVtYWluaW5nID09PSAwKSB7XG4gICAgICAgIHJlc29sdmUoYXJncyk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgcmVzKGksIGFyZ3NbaV0pO1xuICAgIH1cbiAgfSk7XG59O1xuXG5Qcm9taXNlLnJlamVjdCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHJlamVjdCh2YWx1ZSk7XG4gIH0pO1xufTtcblxuUHJvbWlzZS5yYWNlID0gZnVuY3Rpb24gKHZhbHVlcykge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIGl0ZXJhYmxlVG9BcnJheSh2YWx1ZXMpLmZvckVhY2goZnVuY3Rpb24odmFsdWUpe1xuICAgICAgUHJvbWlzZS5yZXNvbHZlKHZhbHVlKS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuLyogUHJvdG90eXBlIE1ldGhvZHMgKi9cblxuUHJvbWlzZS5wcm90b3R5cGVbJ2NhdGNoJ10gPSBmdW5jdGlvbiAob25SZWplY3RlZCkge1xuICByZXR1cm4gdGhpcy50aGVuKG51bGwsIG9uUmVqZWN0ZWQpO1xufTtcbiJdfQ==